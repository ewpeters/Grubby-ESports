%style{:type => "text/css", :media => "screen"}
  :plain
    #slideshow {
    	width: 586px;
      height: 455px;
    	position:absolute;
    	top: 0px;
      background: -moz-linear-gradient(top right,  #4e4f4f,  #e6e6e6);
      background: -webkit-gradient(linear,  right top, left bottom, from(#4e4f4f), to(#e6e6e6));
    }
    #slideshow #slidesContainer {
      margin:0 auto;
      width: 555px;
      height: 455px;
    }
    #slideshow #slidesContainer .slide {
      margin: auto;
      width: 555px;
      height: 455px;
    }
    .top_bar {
      background-color: black;
      height: 25px;
      width: 100%;
      left: 0px;
      position: absolute;
      top: 0px;
      z-index: 2;
      background: -moz-linear-gradient(right,  #0c0c0c,  #1f2121);
      background: -webkit-gradient(linear,  left , right , from(#0c0c0c), to(#1f2121));
    }
    .bottom_bar {
      background-color: black;
      height: 60px;
      width: 100%;
      position: absolute;
      bottom: 0px;
      z-index: 2;
      left: 0px;
      background: -moz-linear-gradient(right,  #0c0c0c,  #1f2121);
      background: -webkit-gradient(linear,  left , right , from(#0c0c0c), to(#1f2121));
    }
    
    .side_bar {
      background-color: black;
      height: 100%;
      width: 20px;
      position: absolute;
      top: 0px;
      z-index: 2;
      left: -20px;
    }
    .title {
      background-color: transparent;
      height: 20px;
      position: relative;
      z-index: 3;
    }
    
    div.photo {
      height: 375px;
      line-height: 375px;
      text-align: center;
      width: 375px;
    }
    
    *>div.photo {
    	font-size:12px
    }
    
    .photo img {
      vertical-align: middle;
    }
    .desc {
      height: 60px;
      position: relative;
      z-index: 3;
      width: 85%;
    }
    /** 
     * Slideshow controls style rules.
     */
    .control {
      display:block;
      width:39px;
      height:263px;
      text-indent:-10000px;
      position:absolute;
      cursor: pointer;
    }
    #leftControl {
      top: 70px;
      left:0;
      background:transparent url(/images/control_left.png) no-repeat 0 0;
    }
    #rightControl {
      right: -18px;
      top: 70px;
      background:transparent url(/images/control_right.png) no-repeat 0 0;
    }
:javascript
  $(document).ready(function(){
    var currentPosition = 0;
    var slideWidth = 560;
    var slides = $('.slide');
    var numberOfSlides = slides.length;

    // Remove scrollbar in JS
    $('#slidesContainer').css('overflow', 'hidden');
    $('#album_box').css('overflow', 'hidden');
    // Wrap all .slides with #slideInner div
    slides
      .wrapAll('<div id="slideInner"></div>')
      // Float left to display horizontally, readjust .slides width
  	.css({
        'float' : 'left',
        'width' : slideWidth
      });

    // Set #slideInner width equal to total width of all slides
    $('#slideInner').css('width', slideWidth * numberOfSlides);

    // Insert controls in the DOM
    $('#slideshow')
      .prepend('<span class="control" id="leftControl">Clicking moves left</span>')
      .append('<span class="control" id="rightControl">Clicking moves right</span>');

    // Hide left arrow control on first load
    manageControls(currentPosition);

    // Create event listeners for .controls clicks
    $('.control')
      .bind('click', function(){
      // Determine new position
      $.get('albums/slide_click/#{@album.id}', function(data) {});
  	currentPosition = ($(this).attr('id')=='rightControl') ? currentPosition+1 : currentPosition-1;

  	// Hide / show controls
      manageControls(currentPosition);
      // Move slideInner using margin-left
      $('#slideInner').animate({
        'marginLeft' : slideWidth*(-currentPosition)
      });
    });
    

    // manageControls: Hides and Shows controls depending on currentPosition
    function manageControls(position){
      // Hide left arrow if position is first slide
  	if(position==0){ $('#leftControl').hide() } else{ $('#leftControl').show() }
  	// Hide right arrow if position is last slide
      if(position==numberOfSlides-1){ $('#rightControl').hide() } else{ $('#rightControl').show() }
    };
    currentPosition = #{@position || 0};
    $('#slideInner').css(
      'margin-left' , slideWidth*(-currentPosition)
    );
    manageControls(currentPosition);
    	
  });
/ = image_tag(p.picture.url(:normal), :size => '555x375')
#album_box{:style => "right: 20px; top: 20px; height: 455px; overflow: hidden;"}
  %div.top_bar
  %div#slideshow
    %div#slidesContainer
      - @album.photos.each do |p|
        .slide
          %center
            %div.title= p.title || p.album.title
            %div.photo{:style => "width: 555px;"}
              = image_tag(p.picture.url(:normal))
            %div.desc= p.description || p.album.description
  %div.bottom_bar
    %a{:href => album_path(@album), :style => "position: absolute; left: 0px;"}
      = image_tag("/images/gallery_backtoalbum_icon.png")

            

